(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    276924,       7591]
NotebookOptionsPosition[    264666,       7189]
NotebookOutlinePosition[    265129,       7207]
CellTagsIndexPosition[    265086,       7204]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Steam-Punk Lambda:
General Computation with Fixed-Sized Matrices\
\>", "Title"],

Cell["\<\
Brian Beckman, Erik Meijer, David Leibs
Dec 2012
Brisbane, Australia\
\>", "Subtitle"],

Cell["\<\
Can we do arbitrary computations using only operations on 4x4 matrices? We'd \
like that since we might be able to run them on a GPU. The idea is to compile \
ordinary code to operations on 4x4 matrices, as if that were the instruction \
set of our machine. Contrast this against OpenACC or CUDA, which are \
basically DSLs for the GPU embedded in ordinary programming languages. \
\>", "Text"],

Cell[CellGroupData[{

Cell["EVERYTHING IS A 4X4 MATRIX", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"script", "[", "c_", "]"}], ":=", 
  RowBox[{"Quiet", "@", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"\"\<\\\\[Script\>\"", "<>", "\"\<Capital\>\"", "<>", 
     RowBox[{"ToUpperCase", "[", 
      RowBox[{"ToString", "[", "c", "]"}], "]"}], "<>", "\"\<]\>\""}], 
    "]"}]}]}]], "Input",
 CellOpen->False,
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"double", "[", "c_", "]"}], ":=", 
  RowBox[{"Quiet", "@", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"\"\<\\\\[DoubleStruck\>\"", "<>", "\"\<Capital\>\"", "<>", 
     RowBox[{"ToUpperCase", "[", 
      RowBox[{"ToString", "[", "c", "]"}], "]"}], "<>", "\"\<]\>\""}], 
    "]"}]}]}]], "Input",
 CellOpen->False,
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"greek", "[", "c_", "]"}], ":=", 
  RowBox[{"Quiet", "@", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "c", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<a\>\"", "\[Rule]", "\[Alpha]"}], ",", 
       RowBox[{"\"\<b\>\"", "\[Rule]", "\[Beta]"}], ",", 
       RowBox[{"\"\<c\>\"", "\[Rule]", "\[Gamma]"}], ",", 
       RowBox[{"\"\<d\>\"", "\[Rule]", "\[Delta]"}], ",", 
       RowBox[{"\"\<e\>\"", "\[Rule]", "\[Epsilon]"}], ",", 
       RowBox[{"\"\<f\>\"", "\[Rule]", "\[Phi]"}], ",", 
       RowBox[{"\"\<g\>\"", "\[Rule]", "\[Chi]"}], ",", 
       RowBox[{"\"\<h\>\"", "\[Rule]", "\[Eta]"}], ",", 
       RowBox[{"\"\<i\>\"", "\[Rule]", "\[Iota]"}], ",", 
       RowBox[{"\"\<j\>\"", "\[Rule]", "\[CurlyPhi]"}], ",", 
       RowBox[{"\"\<k\>\"", "\[Rule]", "\[Kappa]"}], ",", 
       RowBox[{"\"\<l\>\"", "\[Rule]", "\[Lambda]"}], ",", 
       RowBox[{"\"\<m\>\"", "\[Rule]", "\[Mu]"}], ",", 
       RowBox[{"\"\<n\>\"", "\[Rule]", "\[Nu]"}], ",", 
       RowBox[{"\"\<o\>\"", "\[Rule]", "\[Omicron]"}], ",", 
       RowBox[{"\"\<p\>\"", "\[Rule]", "\[Pi]"}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", "\[Theta]"}], ",", 
       RowBox[{"\"\<r\>\"", "\[Rule]", "\[Rho]"}], ",", 
       RowBox[{"\"\<s\>\"", "\[Rule]", "\[Sigma]"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "\[Tau]"}], ",", 
       RowBox[{"\"\<u\>\"", "\[Rule]", "\[Upsilon]"}], ",", 
       RowBox[{"\"\<w\>\"", "\[Rule]", "\[Omega]"}], ",", 
       RowBox[{"\"\<x\>\"", "\[Rule]", "\[Xi]"}], ",", 
       RowBox[{"\"\<y\>\"", "\[Rule]", "\[Psi]"}], ",", 
       RowBox[{"\"\<z\>\"", "\[Rule]", "\[Zeta]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellOpen->False,
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"pv", "[", 
   RowBox[{"ul_", ",", "ur_", ",", "ll_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"ul", "ur", 
      RowBox[{"greek", "@", "ul"}], 
      RowBox[{"greek", "@", "ur"}]},
     {"ll", "lr", 
      RowBox[{"greek", "@", "ll"}], 
      RowBox[{"greek", "@", "lr"}]},
     {
      RowBox[{"script", "@", "ul"}], 
      RowBox[{"script", "@", "ur"}], 
      RowBox[{"double", "@", "ul"}], 
      RowBox[{"double", "@", "ur"}]},
     {
      RowBox[{"script", "@", "ll"}], 
      RowBox[{"script", "@", "lr"}], 
      RowBox[{"double", "@", "ll"}], 
      RowBox[{"double", "@", "lr"}]}
    }], "\[NoBreak]", ")"}]}]], "Input",
 CellOpen->False,
 InitializationCell->True],

Cell["\<\
Consider arbitrary 4x4 matrices, broken into four 2x2 blocks. \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "@", 
  RowBox[{"{", 
   RowBox[{"MatrixForm", "/@", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"pv", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"pv", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "]"}]}]}], "}"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"x", "y", "\[Xi]", "\[Psi]"},
         {"z", "w", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The upper-left corner is special", "Subsection"],

Cell["Divide matrices into equivalence classes:", "Text"],

Cell["\<\
All matrices with the same upper-left 2x2 block are equivalent -- they all \
represent the same value in the system. The contents of the other three \
blocks are \"machine-state,\" but the value of the matrix as a whole is just \
the value of the 2x2 block in the upper-left corner. \
\>", "Text"],

Cell[TextData[{
 "The prime representative of an equivalence class is the ",
 StyleBox["[CHIEF]",
  FontWeight->"Bold"],
 " of that class. It has the same upper-left 2x2 as every other member of the \
class, but zeros elsewhere. To test whether two matrices are equivalent, \
compare them both to their chiefs."
}], "Text"],

Cell[TextData[{
 "The ",
 StyleBox["[MACHINE-STATE]",
  FontWeight->"Bold"],
 " of a matrix is the contents of all the blocks other than the upper-left \
2x2 block."
}], "Text"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["PRIMITIVE MATRICES", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ill", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"iul", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"iur", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "1", "0"},
      {"0", "0", "0", "1"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"ilr", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "1", "0"},
      {"0", "0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input"],

Cell["Convenience:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"T", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", "Transpose"}], ";", 
  RowBox[{"M", "=", "MatrixForm"}], ";"}]}], "Input"],

Cell[TextData[{
 "Investigate what any particular operator does to a sample matrix in various \
combinations, namely ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", ".", "p", ".", 
    SuperscriptBox["m", "T"]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["m", "T"], ".", "p", ".", "m"}], TraditionalForm]]],
 ", and so on:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"combos", "[", 
    RowBox[{"m_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mT", "=", 
       RowBox[{"m", "//", "T"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"m", ".", "p"}], ",", 
           RowBox[{"p", ".", "mT"}], ",", 
           RowBox[{"m", ".", "p", ".", "mT"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mT", ".", "p"}], ",", 
           RowBox[{"p", ".", "m"}], ",", 
           RowBox[{"mT", ".", "p", ".", "m"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"combos", "[", 
  RowBox[{"ill", ",", "p"}], "]"}]}], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"},
         {"0", "0", "\[ScriptCapitalA]", "\[ScriptCapitalB]"},
         {"0", "0", "\[ScriptCapitalC]", "\[ScriptCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[Alpha]", "\[Beta]", "0", "0"},
         {"\[Gamma]", "\[Delta]", "0", "0"},
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"combos", "[", 
  RowBox[{"iul", ",", "p"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "0", "0"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "0", "0"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["REGISTERS", "Section"],

Cell["\<\
Think of a 4x4 matrix as a machine with four registers: ul, ur, ll, lr, for \
\"upper-left,\" \"upper-right,\" \"lower-left,\" and \"lower-right.\"\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"registers", "=", 
   RowBox[{"{", 
    RowBox[{"iul", ",", "iur", ",", "ill", ",", "ilr"}], "}"}]}], 
  ";"}]], "Input"],

Cell["\<\
ul is like EAX in the x86 machine: it's a special register where you can find \
the result of a computation and where you expect the value of an actual \
argument to a unary function to appear.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["INSTRUCTIONS", "Section"],

Cell[CellGroupData[{

Cell["The MV Instruction", "Subsection"],

Cell["\<\
I can move the CHIEF in the upper left corner into any one of the four \
registers.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MV", "[", 
   RowBox[{"reg_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"reg", "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iul", "\[Rule]", 
      RowBox[{"iul", ".", "m", ".", 
       RowBox[{"(", 
        RowBox[{"iul", "//", "T"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"iur", "\[Rule]", 
      RowBox[{"iul", ".", "m", ".", 
       RowBox[{"(", 
        RowBox[{"ill", "//", "T"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ill", "\[Rule]", 
      RowBox[{"ill", ".", "m", ".", 
       RowBox[{"(", 
        RowBox[{"iul", "//", "T"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ilr", "\[Rule]", 
      RowBox[{"ill", ".", "m", ".", 
       RowBox[{"(", 
        RowBox[{"ill", "//", "T"}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MV", "[", 
        RowBox[{"#", ",", "p"}], "]"}], "//", "M"}], ")"}], "&"}], "/@", 
    "registers"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[TextData[{
 "MV is ",
 StyleBox["hippocratic",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ": If its first argument is not a register, MV produces its first argument."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MV", "[", 
   RowBox[{"p", ",", "q"}], "]"}], "//", "M"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "\[Alpha]", "\[Beta]"},
     {"c", "d", "\[Gamma]", "\[Delta]"},
     {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]", 
      "\[DoubleStruckCapitalB]"},
     {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]", 
      "\[DoubleStruckCapitalD]"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The AMV Instruction", "Subsection"],

Cell["\<\
Move any one of the four registers into ul, the CHIEF position. These \
operations are all conjugates of the corresponding MV instructions. \
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AMV", "[", 
   RowBox[{"reg_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"reg", "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iul", "\[Rule]", 
      RowBox[{"iul", ".", "m", ".", 
       RowBox[{"(", 
        RowBox[{"iul", "//", "T"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"iur", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"iul", "//", "T"}], ")"}], ".", "m", ".", "ill"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ill", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ill", "//", "T"}], ")"}], ".", "m", ".", "iul"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ilr", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ill", "//", "T"}], ")"}], ".", "m", ".", "ill"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"AMV", "[", 
        RowBox[{"#", ",", "p"}], "]"}], "//", "M"}], ")"}], "&"}], "/@", 
    "registers"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[Alpha]", "\[Beta]", "0", "0"},
         {"\[Gamma]", "\[Delta]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "0", "0"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The CHF Instruction", "Subsection"],

Cell["\<\
Extract the CHIEF of any matrix by masking off the MACHINE-STATE portion\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CHF", "[", "m_", "]"}], ":=", 
   RowBox[{"iul", ".", "m", ".", 
    RowBox[{"(", 
     RowBox[{"iul", "//", "T"}], ")"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CHF", "[", "p", "]"}], "//", "M"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "0", "0"},
     {"c", "d", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The ST Instruction", "Subsection"],

Cell["\<\
Extract the MACHINE-STATE from any matrix -- the ANTI-CHIEF as it were.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ST", "[", "m_", "]"}], ":=", 
  RowBox[{"m", "-", 
   RowBox[{"CHF", "[", "m", "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ST", "[", "p", "]"}], "//", "M"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "\[Alpha]", "\[Beta]"},
     {"0", "0", "\[Gamma]", "\[Delta]"},
     {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]", 
      "\[DoubleStruckCapitalB]"},
     {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]", 
      "\[DoubleStruckCapitalD]"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"M", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ap", "=", 
       RowBox[{"ST", "[", "p", "]"}]}], ",", 
      RowBox[{"aq", "=", 
       RowBox[{"ST", "[", "q", "]"}]}]}], "}"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "\[Alpha]", "\[Beta]"},
         {"0", "0", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "\[Xi]", "\[Psi]"},
         {"0", "0", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The CY instruction", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CY", "[", 
   RowBox[{"r1_", ",", "r2_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"MV", "[", 
   RowBox[{"r2", ",", 
    RowBox[{"AMV", "[", 
     RowBox[{"r1", ",", "m"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "@", 
  RowBox[{"{", 
   RowBox[{"M", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CY", "[", 
       RowBox[{"iul", ",", "ilr", ",", "p"}], "]"}], ",", 
      RowBox[{"CY", "[", 
       RowBox[{"ilr", ",", "iul", ",", "p"}], "]"}]}], "}"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "@", 
  RowBox[{"(", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"M", "@", 
       RowBox[{"CY", "[", 
        RowBox[{"#1", ",", "#2", ",", "p"}], "]"}]}], "&"}], ",", "registers",
      ",", "registers", ",", "1"}], "]"}], ")"}]}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[Alpha]", "\[Beta]", "0", "0"},
         {"\[Gamma]", "\[Delta]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "\[Alpha]", "\[Beta]"},
         {"0", "0", "\[Gamma]", "\[Delta]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"\[Alpha]", "\[Beta]", "0", "0"},
         {"\[Gamma]", "\[Delta]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "\[Alpha]", "\[Beta]"},
         {"0", "0", "\[Gamma]", "\[Delta]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "0", "0"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "\[ScriptCapitalA]", "\[ScriptCapitalB]"},
         {"0", "0", "\[ScriptCapitalC]", "\[ScriptCapitalD]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "0", "0"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "\[ScriptCapitalA]", "\[ScriptCapitalB]"},
         {"0", "0", "\[ScriptCapitalC]", "\[ScriptCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]"},
         {"0", "0", "\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]"},
         {"0", "0", "\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Booleans", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"falseMatrix", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"trueMatrix", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {"0", "0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input"],

Cell["trueMatrix composed with any matrix is that matrix", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"trueMatrix", ".", "p"}], "===", "p"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["falseMatrix annihilates any matrix", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"falseMatrix", ".", "p"}], "===", "falseMatrix"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["A falsey matrix is one whose CHIEF matches the false matrix", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"falsey", "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CHF", "[", "m", "]"}], "===", "falseMatrix"}]}]], "Input"],

Cell["A truthy matrix is one whose CHIEF is not falsey", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"truthy", "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CHF", "[", "m", "]"}], "=!=", "falseMatrix"}]}]], "Input"],

Cell["\<\
The other registers don't matter when testing truthiness or falseyness\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"truthy", "[", 
     RowBox[{"MV", "[", 
      RowBox[{"#", ",", "p"}], "]"}], "]"}], ")"}], "&"}], "/@", 
  "registers"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"falsey", "[", 
     RowBox[{"MV", "[", 
      RowBox[{"#", ",", "p"}], "]"}], "]"}], ")"}], "&"}], "/@", 
  "registers"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True", ",", "True", ",", "True"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GENETIC SEARCH FOR NAND", "Section"],

Cell["\<\
First, write a postfix calculator for instructions so that we can construct \
strings of instructions. Then, treat those strings as genomes and genetically \
search for the fomulas we need (David says: maybe we can use probabilistic \
fitness functions)\
\>", "Text"],

Cell[CellGroupData[{

Cell["Stack", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "pushR", ",", "popR", ",", "dupR", ",", "rotR", ",", "swapR", ",", "topR",
      ",", "nextR", ",", "thirdR"}], "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"stack", "-", "to", "-", 
    RowBox[{"stack", " ", "transforms"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pushR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "stack___", "}"}], ",", "datum_"}], "}"}], 
     "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"datum", ",", "stack"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"popR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"top_", ",", "rest___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "rest", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dupR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"top_", ",", "rest___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"top", ",", "top", ",", "rest"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"top_", ",", "rest___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"rest", ",", "top"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swapR", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"top_", ",", "next_", ",", "rest___"}], "}"}], 
      "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"next", ",", "top", ",", "rest"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"stack", "-", "to", "-", 
    RowBox[{"value", " ", "transforms"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"top_", ",", "___"}], "}"}], "\[RuleDelayed]", "top"}], ",", 
     RowBox[{
      RowBox[{"{", "}"}], "\[RuleDelayed]", "falseMatrix"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"top_", ",", "next_", ",", "___"}], "}"}], "\[RuleDelayed]", 
      "next"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "_", "}"}], "|", 
        RowBox[{"{", "}"}]}], ")"}], "\[RuleDelayed]", "falseMatrix"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thirdR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"top_", ",", "next_", ",", "third_", ",", "___"}], "}"}], 
      "\[RuleDelayed]", "third"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "_", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "|", 
        RowBox[{"{", "}"}]}], ")"}], "\[RuleDelayed]", "falseMatrix"}]}], 
    "}"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exec", "Subsection"],

Cell["\<\
MV, AMV, and CY are unsuitable for machine instructions because they have an \
implicit if-test in them. We need to construct if-tests from more primitive \
operations: plus, dot, minus, inverse, conjugation, determinant, trace, \
transpose, and commutator.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "instructionSet", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"instructionSet", "=", 
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{"MV", ",", "AMV", ",", "CY", ","}], "*)"}], 
    RowBox[{
    "conj2", ",", "plus", ",", "dot", ",", "minus", ",", "div", ",", "conj", 
     ",", "comm", ",", "inv", ",", "det", ",", "tr", ",", "T", ",", "CHF", 
     ",", "ST", ",", "dup", ",", "swap", ",", "rot", ",", 
     RowBox[{"(*", 
      RowBox[{"nop", ","}], "*)"}], "true", ",", "false", ",", "ul", ",", 
     "ur", ",", "ll", ",", "lr"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "exec", ",", "execTrace", ",", "execAll", ",", "execAllTrace", ",", 
    "gridStack"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", "instructionSet"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exec", "[", 
    RowBox[{"stack_", ",", "instr_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"instr", "/.", 
    RowBox[{"Dispatch", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "TERNARY", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"conj2", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nT", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"stack", "/.", "topR"}], ")"}], "//", "Transpose"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"p", "=", 
             RowBox[{"stack", "/.", "nextR"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"m", "=", 
             RowBox[{"stack", "/.", "thirdR"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], "/.", 
              "popR"}], ",", 
             RowBox[{"m", ".", "p", ".", "nT"}]}], "}"}], "/.", "pushR"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"CY", ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", "=", 
             RowBox[{"CY", "[", 
              RowBox[{"third", ",", "next", ",", "top"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"push", "[", "r", "]"}]}]}], "]"}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "BINARIES", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"MV", ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", "=", 
             RowBox[{"MV", "[", 
              RowBox[{"next", ",", "top"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"push", "[", "r", "]"}]}]}], "]"}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"AMV", ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", "=", 
             RowBox[{"AMV", "[", 
              RowBox[{"next", ",", "top"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"pop", "[", "]"}], ";", 
            RowBox[{"push", "[", "r", "]"}]}]}], "]"}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"plus", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"stack", "/.", "nextR"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{"stack", "/.", "topR"}], ")"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", "r"}], 
            "}"}], "/.", "pushR"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"dot", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"stack", "/.", "nextR"}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{"stack", "/.", "topR"}], ")"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", "r"}], 
            "}"}], "/.", "pushR"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"minus", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"stack", "/.", "nextR"}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{"stack", "/.", "topR"}], ")"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", "r"}], 
            "}"}], "/.", "pushR"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"div", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"stack", "/.", "nextR"}], ")"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"stack", "/.", "topR"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", "r"}], 
            "}"}], "/.", "pushR"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"conj", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{"stack", "/.", "nextR"}]}], ",", 
            RowBox[{"p", "=", 
             RowBox[{"stack", "/.", "topR"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", 
             RowBox[{"m", ".", "p", ".", 
              RowBox[{"(", 
               RowBox[{"T", "@", "m"}], ")"}]}]}], "}"}], "/.", "pushR"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"comm", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{"stack", "/.", "nextR"}]}], ",", 
            RowBox[{"p", "=", 
             RowBox[{"stack", "/.", "topR"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stack", "/.", "popR"}], "/.", "popR"}], ",", 
             RowBox[{"m", ".", "p", ".", 
              RowBox[{"(", 
               RowBox[{"T", "@", "m"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"T", "@", "p"}], ")"}]}]}], "}"}], "/.", "pushR"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "UNARIES", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inv", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"stack", "/.", "topR"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", 
            RowBox[{"Inverse", "[", "r", "]"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"det", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"top", "[", "stack", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", 
            RowBox[{"trueMatrix", "*", 
             RowBox[{"Det", "[", "r", "]"}]}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tr", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"top", "[", "stack", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", 
            RowBox[{"trueMatrix", "*", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"r", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"T", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"T", "@", 
             RowBox[{"top", "[", "stack", "]"}]}]}], "}"}], ",", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", "r"}], "]"}]}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"CHF", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"CHF", "[", 
             RowBox[{"top", "[", "stack", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", "r"}], "]"}]}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"ST", "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"ST", "[", 
             RowBox[{"top", "[", "stack", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"push", "[", 
           RowBox[{
            RowBox[{"stack", "//", "pop"}], ",", "r"}], "]"}]}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "NULLARIES", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pop", "\[RuleDelayed]", 
        RowBox[{"pop", "[", "stack", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"dup", "\[RuleDelayed]", 
        RowBox[{"dup", "[", "stack", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"rot", "\[RuleDelayed]", 
        RowBox[{"rot", "[", "stack", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"swap", "\[RuleDelayed]", 
        RowBox[{"swap", "[", "stack", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"nop", ",", "0", ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "CONSTANTS", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"true", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "trueMatrix"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"false", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "falseMatrix"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ul", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "iul"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ur", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "iur"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ll", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "ill"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"lr", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "ilr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "DEFAULT", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"push", "[", 
         RowBox[{"stack", ",", "instr"}], "]"}]}]}], "\[IndentingNewLine]", 
      "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exec", "[", "___", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"\"\<bad exec: \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"{", "___", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"execTrace", "[", 
    RowBox[{"stack_", ",", "instr_"}], "]"}], ":=", 
   RowBox[{"gridStack", "@", 
    RowBox[{"exec", "[", 
     RowBox[{"stack", ",", "instr"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"execAll", "[", 
    RowBox[{"stack_", ",", "instrs_"}], "]"}], ":=", 
   RowBox[{"gridStack", "@", 
    RowBox[{"Fold", "[", 
     RowBox[{"exec", ",", "stack", ",", "instrs"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"execAllTrace", "[", 
    RowBox[{"stack_", ",", "instrs_"}], "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"M", "/@", "#"}], ")"}], "&"}], "/@", 
     RowBox[{"FoldList", "[", 
      RowBox[{"exec", ",", "stack", ",", "instrs"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridStack", "[", "stack_", "]"}], ":=", 
  RowBox[{"Grid", "[", 
   RowBox[{"{", 
    RowBox[{"M", "/@", "stack"}], "}"}], "]"}]}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit Tests", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"pstack", ",", "qstack", ",", "pqstack", ",", "ranstack"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pstack", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "}"}], "//", 
     RowBox[{
      RowBox[{"push", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "&"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"qstack", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "}"}], "//", 
     RowBox[{
      RowBox[{"push", "[", 
       RowBox[{"#", ",", "q"}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pqstack", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "}"}], "//", 
      RowBox[{
       RowBox[{"push", "[", 
        RowBox[{"#", ",", "p"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"push", "[", 
       RowBox[{"#", ",", "q"}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ranstack", "[", 
   RowBox[{"n_:", "1"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"push", ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "4", ",", "4"}], "}"}]}], "]"}]}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell["push", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", "pstack"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", "pqstack"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"x", "y", "\[Xi]", "\[Psi]"},
         {"z", "w", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["pop", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", 
  RowBox[{"(", 
   RowBox[{"pqstack", "//", "pop"}], ")"}]}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"pqstack", "//", "pop"}], "//", "pop"}], ")"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  TagBox[GridBox[{
     {""}
    },
    AutoDelete->False,
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  Grid[{{}}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"pqstack", "//", "pop"}], "//", "pop"}], ")"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  TagBox[GridBox[{
     {""}
    },
    AutoDelete->False,
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  Grid[{{}}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gridStack", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"pqstack", "//", "pop"}], "//", "pop"}], "//", "pop"}], 
   ")"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  TagBox[GridBox[{
     {""}
    },
    AutoDelete->False,
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  Grid[{{}}]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["plus", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{"pqstack", ",", "plus"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"a", "+", "x"}], 
          RowBox[{"b", "+", "y"}], 
          RowBox[{"\[Alpha]", "+", "\[Xi]"}], 
          RowBox[{"\[Beta]", "+", "\[Psi]"}]},
         {
          RowBox[{"c", "+", "z"}], 
          RowBox[{"d", "+", "w"}], 
          RowBox[{"\[Gamma]", "+", "\[Zeta]"}], 
          RowBox[{"\[Delta]", "+", "\[Omega]"}]},
         {
          RowBox[{"\[ScriptCapitalA]", "+", "\[ScriptCapitalX]"}], 
          RowBox[{"\[ScriptCapitalB]", "+", "\[ScriptCapitalY]"}], 
          RowBox[{"\[DoubleStruckCapitalA]", "+", "\[DoubleStruckCapitalX]"}], 
          RowBox[{"\[DoubleStruckCapitalB]", "+", "\[DoubleStruckCapitalY]"}]},
         {
          RowBox[{"\[ScriptCapitalC]", "+", "\[ScriptCapitalZ]"}], 
          RowBox[{"\[ScriptCapitalD]", "+", "\[ScriptCapitalW]"}], 
          RowBox[{"\[DoubleStruckCapitalC]", "+", "\[DoubleStruckCapitalZ]"}], 
          RowBox[{
          "\[DoubleStruckCapitalD]", "+", "\[DoubleStruckCapitalW]"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{"qstack", ",", "plus"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Thread", "::", "tdlen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Objects of unequal length in \
\[NoBreak]\\!\\(\\(\\({\\({\\(\\({x, y, \[Xi], \[Psi]}\\)\\), \\(\\({z, w, \
\[Zeta], \[Omega]}\\)\\), \\(\\({\[ScriptCapitalX], \[ScriptCapitalY], \
\[DoubleStruckCapitalX], \[DoubleStruckCapitalY]}\\)\\), \\(\\({\
\[ScriptCapitalZ], \[ScriptCapitalW], \[DoubleStruckCapitalZ], \
\[DoubleStruckCapitalW]}\\)\\)}\\)}\\)\\) + \\(\\({\\(\\({x, y, \[Xi], \
\[Psi]}\\)\\), \\(\\({z, w, \[Zeta], \[Omega]}\\)\\), \
\\(\\({\[ScriptCapitalX], \[ScriptCapitalY], \[DoubleStruckCapitalX], \
\[DoubleStruckCapitalY]}\\)\\), \\(\\({\[ScriptCapitalZ], \[ScriptCapitalW], \
\[DoubleStruckCapitalZ], \[DoubleStruckCapitalW]}\\)\\)}\\)\\)\\)\[NoBreak] \
cannot be combined. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Thread/tdlen\\\", ButtonNote -> \
\\\"Thread::tdlen\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "\[Xi]", ",", "\[Psi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "w", ",", "\[Zeta]", ",", "\[Omega]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
           "\[ScriptCapitalX]", ",", "\[ScriptCapitalY]", ",", 
            "\[DoubleStruckCapitalX]", ",", "\[DoubleStruckCapitalY]"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\[ScriptCapitalZ]", ",", "\[ScriptCapitalW]", ",", 
            "\[DoubleStruckCapitalZ]", ",", "\[DoubleStruckCapitalW]"}], 
           "}"}]}], "}"}], "}"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "\[Xi]", ",", "\[Psi]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "w", ",", "\[Zeta]", ",", "\[Omega]"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "\[ScriptCapitalX]", ",", "\[ScriptCapitalY]", ",", 
           "\[DoubleStruckCapitalX]", ",", "\[DoubleStruckCapitalY]"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
          "\[ScriptCapitalZ]", ",", "\[ScriptCapitalW]", ",", 
           "\[DoubleStruckCapitalZ]", ",", "\[DoubleStruckCapitalW]"}], 
          "}"}]}], "}"}]}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "plus"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"{", "}"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pqstack", ",", 
   RowBox[{"{", "plus", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"x", "y", "\[Xi]", "\[Psi]"},
         {"z", "w", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"a", "+", "x"}], 
          RowBox[{"b", "+", "y"}], 
          RowBox[{"\[Alpha]", "+", "\[Xi]"}], 
          RowBox[{"\[Beta]", "+", "\[Psi]"}]},
         {
          RowBox[{"c", "+", "z"}], 
          RowBox[{"d", "+", "w"}], 
          RowBox[{"\[Gamma]", "+", "\[Zeta]"}], 
          RowBox[{"\[Delta]", "+", "\[Omega]"}]},
         {
          RowBox[{"\[ScriptCapitalA]", "+", "\[ScriptCapitalX]"}], 
          RowBox[{"\[ScriptCapitalB]", "+", "\[ScriptCapitalY]"}], 
          RowBox[{"\[DoubleStruckCapitalA]", "+", "\[DoubleStruckCapitalX]"}], 
          RowBox[{"\[DoubleStruckCapitalB]", "+", "\[DoubleStruckCapitalY]"}]},
         {
          RowBox[{"\[ScriptCapitalC]", "+", "\[ScriptCapitalZ]"}], 
          RowBox[{"\[ScriptCapitalD]", "+", "\[ScriptCapitalW]"}], 
          RowBox[{"\[DoubleStruckCapitalC]", "+", "\[DoubleStruckCapitalZ]"}], 
          RowBox[{
          "\[DoubleStruckCapitalD]", "+", "\[DoubleStruckCapitalW]"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{
   RowBox[{"ranstack", "[", "2", "]"}], ",", 
   RowBox[{"{", "plus", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.2586947453378825`", "0.7057980324819184`", "0.4087662972182651`",
           "0.22366786995955734`"},
         {"0.4624684640038168`", "0.151612438134888`", "0.6954551994737503`", 
          "0.8929466934810601`"},
         {"0.4683475225706746`", "0.07296843750016513`", 
          "0.29857876802936656`", "0.8841232382687805`"},
         {"0.45295838661074606`", "0.31295989873066565`", 
          "0.6314672337819567`", "0.0213774338263093`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.39870057342825005`", "0.32206388194573754`", 
          "0.319273772245666`", "0.0819777750148416`"},
         {"0.26286038709388126`", "0.44542514193958116`", 
          "0.9843896806363188`", "0.4647680526699216`"},
         {"0.6964419414545588`", "0.20860273633029758`", 
          "0.3545795587359224`", "0.2014983036316067`"},
         {"0.28738699232259`", "0.20969605744496356`", "0.5948857163509194`", 
          "0.5007003593924455`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.6573953187661326`", "1.027861914427656`", "0.7280400694639311`", 
          "0.30564564497439894`"},
         {"0.7253288510976981`", "0.5970375800744692`", "1.6798448801100692`",
           "1.3577147461509818`"},
         {"1.1647894640252334`", "0.2815711738304627`", "0.653158326765289`", 
          "1.0856215419003872`"},
         {"0.7403453789333361`", "0.5226559561756292`", "1.226352950132876`", 
          "0.5220777932187548`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["dot", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pqstack", ",", 
   RowBox[{"{", "dot", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"x", "y", "\[Xi]", "\[Psi]"},
         {"z", "w", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"a", " ", "x"}], "+", 
           RowBox[{"b", " ", "z"}], "+", 
           RowBox[{"\[ScriptCapitalX]", " ", "\[Alpha]"}], "+", 
           RowBox[{"\[ScriptCapitalZ]", " ", "\[Beta]"}]}], 
          RowBox[{
           RowBox[{"b", " ", "w"}], "+", 
           RowBox[{"a", " ", "y"}], "+", 
           RowBox[{"\[ScriptCapitalY]", " ", "\[Alpha]"}], "+", 
           RowBox[{"\[ScriptCapitalW]", " ", "\[Beta]"}]}], 
          RowBox[{
           RowBox[{"\[DoubleStruckCapitalX]", " ", "\[Alpha]"}], "+", 
           RowBox[{"\[DoubleStruckCapitalZ]", " ", "\[Beta]"}], "+", 
           RowBox[{"b", " ", "\[Zeta]"}], "+", 
           RowBox[{"a", " ", "\[Xi]"}]}], 
          RowBox[{
           RowBox[{"\[DoubleStruckCapitalY]", " ", "\[Alpha]"}], "+", 
           RowBox[{"\[DoubleStruckCapitalW]", " ", "\[Beta]"}], "+", 
           RowBox[{"a", " ", "\[Psi]"}], "+", 
           RowBox[{"b", " ", "\[Omega]"}]}]},
         {
          RowBox[{
           RowBox[{"c", " ", "x"}], "+", 
           RowBox[{"d", " ", "z"}], "+", 
           RowBox[{"\[ScriptCapitalX]", " ", "\[Gamma]"}], "+", 
           RowBox[{"\[ScriptCapitalZ]", " ", "\[Delta]"}]}], 
          RowBox[{
           RowBox[{"d", " ", "w"}], "+", 
           RowBox[{"c", " ", "y"}], "+", 
           RowBox[{"\[ScriptCapitalY]", " ", "\[Gamma]"}], "+", 
           RowBox[{"\[ScriptCapitalW]", " ", "\[Delta]"}]}], 
          RowBox[{
           RowBox[{"\[DoubleStruckCapitalX]", " ", "\[Gamma]"}], "+", 
           RowBox[{"\[DoubleStruckCapitalZ]", " ", "\[Delta]"}], "+", 
           RowBox[{"d", " ", "\[Zeta]"}], "+", 
           RowBox[{"c", " ", "\[Xi]"}]}], 
          RowBox[{
           RowBox[{"\[DoubleStruckCapitalY]", " ", "\[Gamma]"}], "+", 
           RowBox[{"\[DoubleStruckCapitalW]", " ", "\[Delta]"}], "+", 
           RowBox[{"c", " ", "\[Psi]"}], "+", 
           RowBox[{"d", " ", "\[Omega]"}]}]},
         {
          RowBox[{
           RowBox[{"x", " ", "\[ScriptCapitalA]"}], "+", 
           RowBox[{"z", " ", "\[ScriptCapitalB]"}], "+", 
           RowBox[{"\[ScriptCapitalX]", " ", "\[DoubleStruckCapitalA]"}], "+", 
           RowBox[{"\[ScriptCapitalZ]", " ", "\[DoubleStruckCapitalB]"}]}], 
          RowBox[{
           RowBox[{"y", " ", "\[ScriptCapitalA]"}], "+", 
           RowBox[{"w", " ", "\[ScriptCapitalB]"}], "+", 
           RowBox[{"\[ScriptCapitalY]", " ", "\[DoubleStruckCapitalA]"}], "+", 
           RowBox[{"\[ScriptCapitalW]", " ", "\[DoubleStruckCapitalB]"}]}], 
          RowBox[{
           RowBox[{
           "\[DoubleStruckCapitalA]", " ", "\[DoubleStruckCapitalX]"}], "+", 
           RowBox[{
           "\[DoubleStruckCapitalB]", " ", "\[DoubleStruckCapitalZ]"}], "+", 
           RowBox[{"\[ScriptCapitalB]", " ", "\[Zeta]"}], "+", 
           RowBox[{"\[ScriptCapitalA]", " ", "\[Xi]"}]}], 
          RowBox[{
           RowBox[{
           "\[DoubleStruckCapitalB]", " ", "\[DoubleStruckCapitalW]"}], "+", 
           RowBox[{
           "\[DoubleStruckCapitalA]", " ", "\[DoubleStruckCapitalY]"}], "+", 
           RowBox[{"\[ScriptCapitalA]", " ", "\[Psi]"}], "+", 
           RowBox[{"\[ScriptCapitalB]", " ", "\[Omega]"}]}]},
         {
          RowBox[{
           RowBox[{"x", " ", "\[ScriptCapitalC]"}], "+", 
           RowBox[{"z", " ", "\[ScriptCapitalD]"}], "+", 
           RowBox[{"\[ScriptCapitalX]", " ", "\[DoubleStruckCapitalC]"}], "+", 
           RowBox[{"\[ScriptCapitalZ]", " ", "\[DoubleStruckCapitalD]"}]}], 
          RowBox[{
           RowBox[{"y", " ", "\[ScriptCapitalC]"}], "+", 
           RowBox[{"w", " ", "\[ScriptCapitalD]"}], "+", 
           RowBox[{"\[ScriptCapitalY]", " ", "\[DoubleStruckCapitalC]"}], "+", 
           RowBox[{"\[ScriptCapitalW]", " ", "\[DoubleStruckCapitalD]"}]}], 
          RowBox[{
           RowBox[{
           "\[DoubleStruckCapitalC]", " ", "\[DoubleStruckCapitalX]"}], "+", 
           RowBox[{
           "\[DoubleStruckCapitalD]", " ", "\[DoubleStruckCapitalZ]"}], "+", 
           RowBox[{"\[ScriptCapitalD]", " ", "\[Zeta]"}], "+", 
           RowBox[{"\[ScriptCapitalC]", " ", "\[Xi]"}]}], 
          RowBox[{
           RowBox[{
           "\[DoubleStruckCapitalD]", " ", "\[DoubleStruckCapitalW]"}], "+", 
           RowBox[{
           "\[DoubleStruckCapitalC]", " ", "\[DoubleStruckCapitalY]"}], "+", 
           RowBox[{"\[ScriptCapitalC]", " ", "\[Psi]"}], "+", 
           RowBox[{"\[ScriptCapitalD]", " ", "\[Omega]"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{
   RowBox[{"ranstack", "[", "2", "]"}], ",", 
   RowBox[{"{", "dot", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.6459419871648235`", "0.5832604726278194`", "0.877152867615524`", 
          "0.8955438409423873`"},
         {"0.29585309845932617`", "0.6936708170041446`", 
          "0.8343782812263782`", "0.5583280449487256`"},
         {"0.23705917395858145`", "0.36403821558688954`", 
          "0.5945834736806335`", "0.3727085279143252`"},
         {"0.7497067196974592`", "0.9226701743214596`", "0.5602480133689824`",
           "0.4094093429029495`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.43442781878899517`", "0.08886558486682494`", 
          "0.952708916274279`", "0.27223114810661264`"},
         {"0.4856602584317211`", "0.2296369670701912`", 
          "0.29609145180328644`", "0.10759756971049916`"},
         {"0.11779287048482967`", "0.06716478728859543`", 
          "0.9446152669093437`", "0.7702684976747207`"},
         {"0.051233063448530514`", "0.25229400127063495`", 
          "0.11703956998529241`", "0.9086838239525354`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.7130854089720524`", "0.4761943031432261`", "1.721479186897504`", 
          "1.7280123616130498`"},
         {"0.5923038334662325`", "0.3824872774497022`", "1.340764821205444`", 
          "1.3052166908298326`"},
         {"0.36891668749382495`", "0.23863023221716062`", 
          "0.9389112650076161`", "0.9003676477539536`"},
         {"0.8607662067973446`", "0.4194227664871605`", "1.5645829480222366`",
           "1.1069356323017534`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["minus", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pqstack", ",", 
   RowBox[{"{", "minus", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"x", "y", "\[Xi]", "\[Psi]"},
         {"z", "w", "\[Zeta]", "\[Omega]"},
         {"\[ScriptCapitalX]", "\[ScriptCapitalY]", "\[DoubleStruckCapitalX]",
           "\[DoubleStruckCapitalY]"},
         {"\[ScriptCapitalZ]", "\[ScriptCapitalW]", "\[DoubleStruckCapitalZ]",
           "\[DoubleStruckCapitalW]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"a", "-", "x"}], 
          RowBox[{"b", "-", "y"}], 
          RowBox[{"\[Alpha]", "-", "\[Xi]"}], 
          RowBox[{"\[Beta]", "-", "\[Psi]"}]},
         {
          RowBox[{"c", "-", "z"}], 
          RowBox[{"d", "-", "w"}], 
          RowBox[{"\[Gamma]", "-", "\[Zeta]"}], 
          RowBox[{"\[Delta]", "-", "\[Omega]"}]},
         {
          RowBox[{"\[ScriptCapitalA]", "-", "\[ScriptCapitalX]"}], 
          RowBox[{"\[ScriptCapitalB]", "-", "\[ScriptCapitalY]"}], 
          RowBox[{"\[DoubleStruckCapitalA]", "-", "\[DoubleStruckCapitalX]"}], 
          RowBox[{"\[DoubleStruckCapitalB]", "-", "\[DoubleStruckCapitalY]"}]},
         {
          RowBox[{"\[ScriptCapitalC]", "-", "\[ScriptCapitalZ]"}], 
          RowBox[{"\[ScriptCapitalD]", "-", "\[ScriptCapitalW]"}], 
          RowBox[{"\[DoubleStruckCapitalC]", "-", "\[DoubleStruckCapitalZ]"}], 
          RowBox[{
          "\[DoubleStruckCapitalD]", "-", "\[DoubleStruckCapitalW]"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["inv", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{"pstack", ",", "inv"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "+", 
            RowBox[{
            "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", " ", 
             "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", " ", 
             "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
            "b", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "-", 
            RowBox[{
            "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[Alpha]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", " ", 
             "\[Alpha]"}], "+", 
            RowBox[{
            "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[Beta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", " ", 
             "\[Beta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", "\[DoubleStruckCapitalD]", " ", 
             "\[Alpha]"}], "+", 
            RowBox[{"d", " ", "\[DoubleStruckCapitalC]", " ", "\[Beta]"}], 
            "+", 
            RowBox[{"b", " ", "\[DoubleStruckCapitalD]", " ", "\[Gamma]"}], 
            "-", 
            RowBox[{"\[ScriptCapitalD]", " ", "\[Beta]", " ", "\[Gamma]"}], 
            "-", 
            RowBox[{"b", " ", "\[DoubleStruckCapitalC]", " ", "\[Delta]"}], 
            "+", 
            RowBox[{"\[ScriptCapitalD]", " ", "\[Alpha]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{"d", " ", "\[DoubleStruckCapitalB]", " ", "\[Alpha]"}], 
            "-", 
            RowBox[{"d", " ", "\[DoubleStruckCapitalA]", " ", "\[Beta]"}], 
            "-", 
            RowBox[{"b", " ", "\[DoubleStruckCapitalB]", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"\[ScriptCapitalB]", " ", "\[Beta]", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"b", " ", "\[DoubleStruckCapitalA]", " ", "\[Delta]"}], 
            "-", 
            RowBox[{"\[ScriptCapitalB]", " ", "\[Alpha]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]]},
         {
          FractionBox[
           RowBox[{
            RowBox[{
            "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "-", 
            RowBox[{
            "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", " ", 
             "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", " ", 
             "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "+", 
            RowBox[{
            "a", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[Alpha]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", " ", 
             "\[Alpha]"}], "-", 
            RowBox[{
            "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[Beta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", " ", 
             "\[Beta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{"c", " ", "\[DoubleStruckCapitalD]", " ", "\[Alpha]"}], 
            "-", 
            RowBox[{"c", " ", "\[DoubleStruckCapitalC]", " ", "\[Beta]"}], 
            "-", 
            RowBox[{"a", " ", "\[DoubleStruckCapitalD]", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"\[ScriptCapitalC]", " ", "\[Beta]", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"a", " ", "\[DoubleStruckCapitalC]", " ", "\[Delta]"}], 
            "-", 
            RowBox[{"\[ScriptCapitalC]", " ", "\[Alpha]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "c"}], " ", "\[DoubleStruckCapitalB]", " ", 
             "\[Alpha]"}], "+", 
            RowBox[{"c", " ", "\[DoubleStruckCapitalA]", " ", "\[Beta]"}], 
            "+", 
            RowBox[{"a", " ", "\[DoubleStruckCapitalB]", " ", "\[Gamma]"}], 
            "-", 
            RowBox[{"\[ScriptCapitalA]", " ", "\[Beta]", " ", "\[Gamma]"}], 
            "-", 
            RowBox[{"a", " ", "\[DoubleStruckCapitalA]", " ", "\[Delta]"}], 
            "+", 
            RowBox[{"\[ScriptCapitalA]", " ", "\[Alpha]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]]},
         {
          FractionBox[
           RowBox[{
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]"}], 
            "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]"}], 
            "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]"}], 
            "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]"}], 
            "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Delta]"}], 
            "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", 
             "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", "\[ScriptCapitalC]", " ", 
             "\[DoubleStruckCapitalB]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]"}], 
            "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]"}], 
            "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]"}], 
            "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]"}], 
            "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", "c", " ", "\[DoubleStruckCapitalD]"}], 
            "+", 
            RowBox[{"a", " ", "d", " ", "\[DoubleStruckCapitalD]"}], "-", 
            RowBox[{"d", " ", "\[ScriptCapitalC]", " ", "\[Beta]"}], "+", 
            RowBox[{"c", " ", "\[ScriptCapitalD]", " ", "\[Beta]"}], "+", 
            RowBox[{"b", " ", "\[ScriptCapitalC]", " ", "\[Delta]"}], "-", 
            RowBox[{"a", " ", "\[ScriptCapitalD]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{"b", " ", "c", " ", "\[DoubleStruckCapitalB]"}], "-", 
            RowBox[{"a", " ", "d", " ", "\[DoubleStruckCapitalB]"}], "+", 
            RowBox[{"d", " ", "\[ScriptCapitalA]", " ", "\[Beta]"}], "-", 
            RowBox[{"c", " ", "\[ScriptCapitalB]", " ", "\[Beta]"}], "-", 
            RowBox[{"b", " ", "\[ScriptCapitalA]", " ", "\[Delta]"}], "+", 
            RowBox[{"a", " ", "\[ScriptCapitalB]", " ", "\[Delta]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]]},
         {
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", "\[ScriptCapitalC]", " ", 
             "\[DoubleStruckCapitalA]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]"}], 
            "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]"}], 
            "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]"}], 
            "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Gamma]"}], 
            "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", 
             "\[Gamma]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]"}], 
            "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]"}], 
            "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]"}], 
            "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]"}], 
            "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]"}], 
            "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", 
             "\[Alpha]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{"b", " ", "c", " ", "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{"a", " ", "d", " ", "\[DoubleStruckCapitalC]"}], "+", 
            RowBox[{"d", " ", "\[ScriptCapitalC]", " ", "\[Alpha]"}], "-", 
            RowBox[{"c", " ", "\[ScriptCapitalD]", " ", "\[Alpha]"}], "-", 
            RowBox[{"b", " ", "\[ScriptCapitalC]", " ", "\[Gamma]"}], "+", 
            RowBox[{"a", " ", "\[ScriptCapitalD]", " ", "\[Gamma]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]], 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", "c", " ", "\[DoubleStruckCapitalA]"}], 
            "+", 
            RowBox[{"a", " ", "d", " ", "\[DoubleStruckCapitalA]"}], "-", 
            RowBox[{"d", " ", "\[ScriptCapitalA]", " ", "\[Alpha]"}], "+", 
            RowBox[{"c", " ", "\[ScriptCapitalB]", " ", "\[Alpha]"}], "+", 
            RowBox[{"b", " ", "\[ScriptCapitalA]", " ", "\[Gamma]"}], "-", 
            RowBox[{"a", " ", "\[ScriptCapitalB]", " ", "\[Gamma]"}]}], 
           RowBox[{
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalB]", " ", 
             "\[DoubleStruckCapitalC]"}], "-", 
            RowBox[{
            "b", " ", "c", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "a", " ", "d", " ", "\[DoubleStruckCapitalA]", " ", 
             "\[DoubleStruckCapitalD]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Alpha]"}], "-", 
            RowBox[{
            "d", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "c", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Beta]"}], "+", 
            RowBox[{
            "d", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "c", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Beta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalB]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalD]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "-", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Beta]", 
             " ", "\[Gamma]"}], "+", 
            RowBox[{
            "b", " ", "\[ScriptCapitalC]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "a", " ", "\[ScriptCapitalD]", " ", "\[DoubleStruckCapitalA]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "b", " ", "\[ScriptCapitalA]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "a", " ", "\[ScriptCapitalB]", " ", "\[DoubleStruckCapitalC]", 
             " ", "\[Delta]"}], "-", 
            RowBox[{
            "\[ScriptCapitalB]", " ", "\[ScriptCapitalC]", " ", "\[Alpha]", 
             " ", "\[Delta]"}], "+", 
            RowBox[{
            "\[ScriptCapitalA]", " ", "\[ScriptCapitalD]", " ", "\[Alpha]", 
             " ", "\[Delta]"}]}]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{
   RowBox[{"ranstack", "[", "1", "]"}], ",", 
   RowBox[{"{", "inv", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.7952843509023424`", "0.9320741776227925`", "0.5948427139887527`",
           "0.038924784078379515`"},
         {"0.8517109213533662`", "0.16789235437301242`", 
          "0.2526868610171338`", "0.7246844405557276`"},
         {"0.2656210171204374`", "0.3194734069809406`", 
          "0.32953921823512333`", "0.07227685559867791`"},
         {"0.03678029201500732`", "0.8443619445145116`", "0.798417572299293`",
           "0.18408610416675253`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.2959850415934796`", "0.05965733525700079`", 
          "2.8853264620894516`", 
          RowBox[{"-", "1.4302884061102232`"}]},
         {"2.552602564775463`", "0.32665246752911825`", 
          RowBox[{"-", "8.922320962134519`"}], "1.6774641455079196`"},
         {
          RowBox[{"-", "2.7148256926871808`"}], 
          RowBox[{"-", "0.6880563944462974`"}], "10.448059917212591`", 
          RowBox[{"-", "0.8194814672576616`"}]},
         {"0.007375121271476`", "1.4740340690684568`", 
          RowBox[{"-", "4.967075114881801`"}], "1.5781090182501956`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "inv"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Inverse", "::", "matsq"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\({}\\)\[NoBreak] at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] is not a non-empty square matrix. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/matsq\\\", \
ButtonNote -> \\\"Inverse::matsq\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"Inverse", "[", 
       RowBox[{"{", "}"}], "]"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["conj", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execTrace", "[", 
  RowBox[{
   RowBox[{"exec", "[", 
    RowBox[{"pstack", ",", "ul"}], "]"}], ",", "conj"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ul", ",", "conj"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ur", ",", "conj"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "1", "0"},
         {"0", "0", "0", "1"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]", "0", "0"},
         {"\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ll", ",", "conj"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"lr", ",", "conj"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "1", "0"},
         {"0", "0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "\[DoubleStruckCapitalA]", "\[DoubleStruckCapitalB]"},
         {"0", "0", "\[DoubleStruckCapitalC]", "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["conj2", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", "@", 
  RowBox[{"(", 
   RowBox[{"iul", ".", "p", ".", 
    RowBox[{"(", 
     RowBox[{"T", "@", "ill"}], ")"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "a", "b"},
     {"0", "0", "c", "d"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ul", ",", "ll", ",", "conj2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ll", ",", "ul", ",", "conj2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"a", "b", "0", "0"},
         {"c", "d", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"execAllTrace", "[", 
  RowBox[{"pstack", ",", 
   RowBox[{"{", 
    RowBox[{"ll", ",", "ll", ",", "conj2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ""},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "b", "\[Alpha]", "\[Beta]"},
         {"c", "d", "\[Gamma]", "\[Delta]"},
         {"\[ScriptCapitalA]", "\[ScriptCapitalB]", "\[DoubleStruckCapitalA]",
           "\[DoubleStruckCapitalB]"},
         {"\[ScriptCapitalC]", "\[ScriptCapitalD]", "\[DoubleStruckCapitalC]",
           "\[DoubleStruckCapitalD]"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "a", "b"},
         {"0", "0", "c", "d"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], "", ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Open  ]],

Cell["det", "Subsubsection"],

Cell["tr", "Subsubsection"],

Cell["T", "Subsubsection"],

Cell["CHF", "Subsubsection"],

Cell["ST", "Subsubsection"],

Cell["dup", "Subsubsection"],

Cell["swap", "Subsubsection"],

Cell["true", "Subsubsection"],

Cell["false", "Subsubsection"],

Cell["ul", "Subsubsection"],

Cell["ur", "Subsubsection"],

Cell["ll", "Subsubsection"],

Cell["lr", "Subsubsection"],

Cell["ran", "Subsubsection"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RandomString", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"randomString", "[", 
   RowBox[{"n_:", "100"}], "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"instructionSet", ",", "n"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pretty", "[", "ms_", "]"}], ":=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"M", "/@", "#"}], "&"}], "/@", "ms"}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Monte-Carlo Search", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"caught", "=", 
   RowBox[{"{", "}"}]}], ";", "lastgood", ";", 
  RowBox[{"commonbad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "falseMatrix", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";", 
  RowBox[{"count", "=", "0"}], ";", 
  RowBox[{"score", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bin", "[", "bool_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"bool", ",", "1", ",", "0"}], "]"}]}], ";", 
  RowBox[{"maxscore", "=", "0"}], ";", 
  RowBox[{"scorevec", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trial", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rc", "=", "2000"}], ",", 
      RowBox[{"ln", "=", "40"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$RecursionLimit", "=", "rc"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"g", "=", 
          RowBox[{"randomString", "[", "ln", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tt", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"clear", "[", "]"}], ";", 
               RowBox[{"push", "[", "p", "]"}], ";", 
               RowBox[{"push", "[", "q", "]"}], ";", 
               RowBox[{"exec", "[", "g", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"tf", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"clear", "[", "]"}], ";", 
               RowBox[{"push", "[", "p", "]"}], ";", 
               RowBox[{"push", "[", "aq", "]"}], ";", 
               RowBox[{"exec", "[", "g", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ft", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"clear", "[", "]"}], ";", 
               RowBox[{"push", "[", "ap", "]"}], ";", 
               RowBox[{"push", "[", "q", "]"}], ";", 
               RowBox[{"exec", "[", "g", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ff", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"clear", "[", "]"}], ";", 
               RowBox[{"push", "[", "ap", "]"}], ";", 
               RowBox[{"push", "[", "aq", "]"}], ";", 
               RowBox[{"exec", "[", "g", "]"}]}], ")"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"result", "=", 
              RowBox[{"{", 
               RowBox[{"tt", ",", "tf", ",", "ft", ",", "ff"}], "}"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "tt"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"score", "=", "0"}], ";", "\[IndentingNewLine]", 
               RowBox[{"score", "+=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "scorevec", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"bin", "[", 
                   RowBox[{"falsey", "[", 
                    RowBox[{
                    "tt", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], ")"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"score", "+=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "scorevec", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"bin", "[", 
                   RowBox[{"truthy", "[", 
                    RowBox[{
                    "tf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], ")"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"score", "+=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "scorevec", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"bin", "[", 
                   RowBox[{"truthy", "[", 
                    RowBox[{
                    "ft", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], ")"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"score", "+=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "scorevec", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"bin", "[", 
                   RowBox[{"truthy", "[", 
                    RowBox[{
                    "ff", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], ")"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"maxscore", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"score", ",", "maxscore"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"falsey", "[", 
                   RowBox[{
                   "tt", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "&&", 
                  RowBox[{"truthy", "[", 
                   RowBox[{
                   "tf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "&&", 
                  RowBox[{"truthy", "[", 
                   RowBox[{
                   "ft", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "&&", 
                  RowBox[{"truthy", "[", 
                   RowBox[{
                   "ff", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"caught", ",", 
                   RowBox[{"{", 
                    RowBox[{"g", ",", "result"}], "}"}]}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "}"}], "&"}], "/@", "result"}],
                   "=!=", "commonbad"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"pretty", "[", 
                  RowBox[{"lastgood", "=", "result"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"pretty", "@", "lastgood"}]}], "]"}]}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "count", ",", "score", ",", "scorevec", ",", "maxscore", ",", "caught"}], 
   "}"}], "]"}]], "Input"],

Cell[BoxData[
 DynamicBox[
  ToBoxes[{$CellContext`count, $CellContext`score, $CellContext`scorevec, \
$CellContext`maxscore, $CellContext`caught}, StandardForm],
  ImageSizeCache->{484., {4., 13.}}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"pretty", "@", "lastgood"}], "]"}]], "Input"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`pretty[$CellContext`lastgood], StandardForm],
  ImageSizeCache->{192., {4., 13.}}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"count", "=", "0"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"count", "++"}], ";", 
     RowBox[{"trial", "[", "]"}]}], ",", 
    RowBox[{"{", "100000000", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{"foo", ",", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Gen\>\"", ",", 
     RowBox[{"foo", "=", 
      RowBox[{"trial", "[", "]"}]}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Button["Gen", $CellContext`foo = $CellContext`trial[]]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {36., {0., 13.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`foo, 
      "Specifications" :> {
        Button["Gen", $CellContext`foo = $CellContext`trial[]]}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{108., {82., 91.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Genetic Search", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"GLOBAL", " ", "STATE"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pool", ",", "generation", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"TUNING", " ", "PARAMETERS"}], " ", "*)"}], 
     "\[IndentingNewLine]", "generationSize", ",", "\[IndentingNewLine]", 
     "geneLength", ",", "\[IndentingNewLine]", "mutationProbability", ",", 
     "\[IndentingNewLine]", "maxRecombinationPoints", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"FUNCTIONS", " ", "&"}], " ", "RULES"}], " ", "*)"}], 
     "\[IndentingNewLine]", "repool", ",", "fitness", ",", "symbolizer", ",", 
     "run", ",", "bin", ",", "\[IndentingNewLine]", "scoreResult", ",", 
     "swap", ",", "recombine", ",", "mutate"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generationSize", "=", 
    RowBox[{"4", "*", "3"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"must", " ", "be", " ", "divisible", " ", "by", " ", "four"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mutationProbability", "=", "0.10"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"geneLength", "=", "40"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"can", " ", 
    RowBox[{"change", "!"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxRecombinationPoints", "=", 
    RowBox[{"geneLength", "/", "10"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bin", "[", "bool_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"bool", ",", "1", ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repool", "[", "]"}], ":=", 
   RowBox[{"pool", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"randomString", "[", "geneLength", "]"}], ",", 
      RowBox[{"{", "generationSize", "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repool", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symbolizer", "=", 
   RowBox[{"Dispatch", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iul", "\[Rule]", "\"\<iul\>\""}], ",", 
      RowBox[{"iur", "\[Rule]", "\"\<iur\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"ill", "\[Rule]", "\"\<ill\>\""}], ",", 
      RowBox[{"ilr", "\[Rule]", "\"\<ilr\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"plus", "\[Rule]", "\"\<+\>\""}], ",", 
      RowBox[{"minus", "\[Rule]", "\"\<-\>\""}], ",", 
      RowBox[{"dot", "\[Rule]", "\"\<.\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"true", "\[Rule]", "\"\<t\>\""}], ",", 
      RowBox[{"false", "\[Rule]", "\"\<f\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"falseMatrix", "\[Rule]", "\"\<f\>\""}], ",", 
      RowBox[{"trueMatrix", "\[Rule]", "\"\<t\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "\[Rule]", "\"\<T\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scoreResult", "[", 
    RowBox[{"{", 
     RowBox[{"tt_", ",", "tf_", ",", "ft_", ",", "ff_"}], "}"}], "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"score", "=", "0"}], ",", 
       RowBox[{"scorevec", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "4"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "tt"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"score", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"score", "+=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "scorevec", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"bin", "[", 
             RowBox[{"falsey", "[", 
              RowBox[{
              "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"score", "+=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "scorevec", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"bin", "[", 
             RowBox[{"truthy", "[", 
              RowBox[{
              "tf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"score", "+=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "scorevec", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"bin", "[", 
             RowBox[{"truthy", "[", 
              RowBox[{
              "ft", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"score", "+=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "scorevec", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"bin", "[", 
             RowBox[{"truthy", "[", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "]"}]}], ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<score\>\"", "\[Rule]", "score"}], ",", 
        RowBox[{"\"\<scorevec\>\"", "\[Rule]", "scorevec"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitness", "[", "gene_", "]"}], ":=", 
   RowBox[{
    RowBox[{"fitness", "[", "gene", "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"score", "=", "0"}], ",", 
        RowBox[{"scorevec", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "4"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tt", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"clear", "[", "]"}], ";", 
             RowBox[{"push", "[", "p", "]"}], ";", 
             RowBox[{"push", "[", "q", "]"}], ";", 
             RowBox[{"exec", "[", "gene", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tf", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"clear", "[", "]"}], ";", 
             RowBox[{"push", "[", "p", "]"}], ";", 
             RowBox[{"push", "[", "aq", "]"}], ";", 
             RowBox[{"exec", "[", "gene", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ft", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"clear", "[", "]"}], ";", 
             RowBox[{"push", "[", "ap", "]"}], ";", 
             RowBox[{"push", "[", "q", "]"}], ";", 
             RowBox[{"exec", "[", "gene", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ff", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"clear", "[", "]"}], ";", 
             RowBox[{"push", "[", "ap", "]"}], ";", 
             RowBox[{"push", "[", "aq", "]"}], ";", 
             RowBox[{"exec", "[", "gene", "]"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"result", "=", 
            RowBox[{"{", 
             RowBox[{"tt", ",", "tf", ",", "ft", ",", "ff"}], "}"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<gene\>\"", "\[Rule]", "gene"}], "/.", 
              "symbolizer"}], ",", 
             RowBox[{
              RowBox[{"\"\<result\>\"", "\[Rule]", "result"}], "/.", 
              "symbolizer"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Length", "@", "gene"}]}]}], "}"}], 
           "\[IndentingNewLine]", "~", "Join", "~", 
           RowBox[{"(", 
            RowBox[{"scoreResult", "@", "result"}], ")"}]}]}], "]"}]}], 
       "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutate", "[", "survivor_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomReal", "[", "]"}], "<", "mutationProbability"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"position", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"\"\<length\>\"", "/.", "survivor"}]}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"oldInstruction", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\"\<gene\>\"", "/.", "survivor"}], ")"}], 
            "\[LeftDoubleBracket]", "position", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newInstructionSet", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{"instructionSet", ",", 
               RowBox[{"{", "oldInstruction", "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"newInstruction", "=", 
               RowBox[{"RandomChoice", "[", "newInstructionSet", "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"oldGene", "=", 
                 RowBox[{"(", 
                  RowBox[{"\"\<gene\>\"", "/.", "survivor"}], ")"}]}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "position", ",", "oldInstruction", ",", "newInstruction", 
                    ",", "oldGene"}], "}"}], "/.", "symbolizer"}], "]"}], 
                 ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "oldGene", "\[LeftDoubleBracket]", "position", 
                   "\[RightDoubleBracket]"}], "=", "newInstruction"}], ")"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                    RowBox[{"{", "oldGene", "}"}], "/.", "symbolizer"}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<gene\>\"", "\[Rule]", "oldGene"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\"\<length\>\"", "\[Rule]", "\"\<length\>\""}], "/.",
                    "survivor"}]}], "}"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", "survivor"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swap", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g1_", ",", "g2_"}], "}"}], ",", "n_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g1", "\[LeftDoubleBracket]", 
        RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], "~", "Join", "~", 
       RowBox[{"g2", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{
       RowBox[{"g2", "\[LeftDoubleBracket]", 
        RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], "~", "Join", "~", 
       RowBox[{"g1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}]}], "}"}],
    FontWeight->"Plain"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recombine", "[", 
    RowBox[{"survivor1_", ",", "survivor2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"\"\<length\>\"", "/.", "survivor1"}], ",", 
         RowBox[{"\"\<length\>\"", "/.", "survivor2"}]}], "]"}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rPoints", "=", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "l"}], "}"}], ",", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "maxRecombinationPoints"}], "}"}], "]"}]}], 
           "]"}], "//", "Union"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Fold", "[", 
        RowBox[{"swap", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<gene\>\"", "/.", "survivor1"}], ",", 
           RowBox[{"\"\<gene\>\"", "/.", "survivor2"}]}], "}"}], ",", 
         "rPoints"}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"run", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recombined", ",", "mutated", ",", "winners"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"generation", "=", 
       RowBox[{"Sort", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fitness", "/@", "pool"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ",", "s"}], "}"}], "\[Function]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<score\>\"", "/.", "f"}], ")"}], ">", 
           RowBox[{"(", 
            RowBox[{"\"\<score\>\"", "/.", "s"}], ")"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"winners", "=", 
       RowBox[{"generation", "\[LeftDoubleBracket]", 
        RowBox[{";;", 
         RowBox[{"generationSize", "/", "2"}]}], "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"mutated", "=", 
       RowBox[{"mutate", "/@", "winners"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"Divisible", "[", 
          RowBox[{"generationSize", ",", "4"}], "]"}]}], ",", 
        RowBox[{"Throw", "[", "\"\<bad generationSize\>\"", "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"recombined", "=", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"recombine", ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mutated", "\[LeftDoubleBracket]", 
               RowBox[{";;", 
                RowBox[{"generationSize", "/", "4"}]}], 
               "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mutated", "\[LeftDoubleBracket]", 
                RowBox[{"1", "+", 
                 RowBox[{"generationSize", "/", "4"}]}], 
                "\[RightDoubleBracket]"}], ";;"}]}], "}"}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "mutated"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"<<", "\"\<Jacquard.m\>\""}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"repool", "[", "]"}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"run", "[", "]"}], "/.", "symbolizer"}], "//", 
   "Length"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["I caught a fish!", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "firstFish", ",", "fish", ",", "tt", ",", "tf", ",", "ft", ",", "ff"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fish", "=", 
   RowBox[{"{", 
    RowBox[{
    "CHF", ",", "dot", ",", "iul", ",", "AMV", ",", "iul", ",", "plus", ",", 
     "ill", ",", "iul", ",", "CY", ",", "ill", ",", "AMV"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clear", "[", "]"}], ";", 
  RowBox[{"tt", "=", 
   RowBox[{"exec", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], "~", "Join", "~", "fish"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clear", "[", "]"}], ";", 
  RowBox[{"tf", "=", 
   RowBox[{"exec", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "aq"}], "}"}], "~", "Join", "~", "fish"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clear", "[", "]"}], ";", 
  RowBox[{"ft", "=", 
   RowBox[{"exec", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ap", ",", "q"}], "}"}], "~", "Join", "~", "fish"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clear", "[", "]"}], ";", 
  RowBox[{"ff", "=", 
   RowBox[{"exec", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ap", ",", "aq"}], "}"}], "~", "Join", "~", "fish"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"MapThread", "[", 
   RowBox[{"Map", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pretty", "[", 
          RowBox[{"{", "#", "}"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"falsey", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], "&"}], ",", "Length"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tt", ",", "tf", ",", "ft", ",", "ff"}], "}"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \[NoBreak]\\!\\(Throw[\\\"bad exec: {___}\\\"]\\)\
\[NoBreak] returned to top level. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", \
ButtonNote -> \\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"bad exec: {___}\"\>", "]"}], "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(tt \[LeftDoubleBracket] \
1 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(tt \[LeftDoubleBracket] \
1 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(tf \[LeftDoubleBracket] \
1 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partd\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"Grid", "[", 
      RowBox[{"{", "tt", "}"}], "]"}], 
     RowBox[{"Grid", "[", 
      RowBox[{"{", "tf", "}"}], "]"}], 
     RowBox[{"Grid", "[", 
      RowBox[{"{", "ft", "}"}], "]"}], 
     RowBox[{"Grid", "[", 
      RowBox[{"{", "ff", "}"}], "]"}]},
    {"False", "False", "False", "False"},
    {"0", "0", "0", "0"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PRENAND", "[", 
   RowBox[{"m1_", ",", "m2_"}], "]"}], ":=", 
  RowBox[{"iul", "+", 
   RowBox[{"AMV", "[", 
    RowBox[{"iul", ",", 
     RowBox[{"m1", ".", 
      RowBox[{"CHF", "[", "m2", "]"}]}]}], "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"M", "/@", 
    RowBox[{"MapThread", "[", 
     RowBox[{"PRENAND", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "p", ",", "ap", ",", "ap"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "aq", ",", "q", ",", "aq"}], "}"}]}], "}"}]}], 
     "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"1", "+", 
           RowBox[{"a", " ", "x"}], "+", 
           RowBox[{"b", " ", "z"}]}], 
          RowBox[{
           RowBox[{"b", " ", "w"}], "+", 
           RowBox[{"a", " ", "y"}]}], "0", "0"},
         {
          RowBox[{
           RowBox[{"c", " ", "x"}], "+", 
           RowBox[{"d", " ", "z"}]}], 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", "w"}], "+", 
           RowBox[{"c", " ", "y"}]}], "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "0", "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AMV", "[", 
   RowBox[{
    RowBox[{"CY", "[", 
     RowBox[{
      RowBox[{"iul", "+", 
       RowBox[{"AMV", "[", 
        RowBox[{"iul", ",", 
         RowBox[{"p", ".", 
          RowBox[{"CHF", "[", "q", "]"}]}]}], "]"}]}], ",", "ill", ",", 
      "iul"}], "]"}], ",", "ill"}], "]"}], "//", "M"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      RowBox[{"1", "+", 
       RowBox[{"a", " ", "x"}], "+", 
       RowBox[{"b", " ", "z"}]}], 
      RowBox[{
       RowBox[{"b", " ", "w"}], "+", 
       RowBox[{"a", " ", "y"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"c", " ", "x"}], "+", 
       RowBox[{"d", " ", "z"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", "w"}], "+", 
       RowBox[{"c", " ", "y"}]}], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["HORIZON", "Section"],

Cell["Don't look below this line.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"saveMe", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CHF", ",", "dot", ",", "plus", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        "pop", ",", "AMV", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        "plus", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        "true", ",", "CY", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        "AMV", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        "pop", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{"a", " ", "x"}], "+", 
               RowBox[{"b", " ", "z"}]}], ",", 
              RowBox[{
               RowBox[{"b", " ", "w"}], "+", 
               RowBox[{"a", " ", "y"}]}], ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"c", " ", "x"}], "+", 
               RowBox[{"d", " ", "z"}]}], ",", 
              RowBox[{"1", "+", 
               RowBox[{"d", " ", "w"}], "+", 
               RowBox[{"c", " ", "y"}]}], ",", "0", ",", "0"}], "}"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
         "}"}]}], "}"}]}], "}"}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Other Primitive Operators", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u3d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0"},
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"u4d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"1", "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"iul", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "@", 
  RowBox[{"combos", "[", 
   RowBox[{"u3d", ",", "p"}], "]"}]}]], "Input"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`combos[$CellContext`u3d, $CellContext`p], StandardForm],
  ImageSizeCache->{163., {4., 13.}}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "@", 
  RowBox[{"combos", "[", 
   RowBox[{"u4d", ",", "p"}], "]"}]}]], "Input"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`combos[$CellContext`u4d, $CellContext`p], StandardForm],
  ImageSizeCache->{163., {4., 13.}}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "@", 
  RowBox[{"combos", "[", 
   RowBox[{"u4d", ",", "p"}], "]"}]}]], "Input"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`combos[$CellContext`u4d, $CellContext`p], StandardForm],
  ImageSizeCache->{163., {4., 13.}}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1262, 1510},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
ShowSelection->True,
Magnification->1.5,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 89, 3, 157, "Title"],
Cell[671, 27, 96, 4, 85, "Subtitle"],
Cell[770, 33, 404, 6, 131, "Text"],
Cell[CellGroupData[{
Cell[1199, 43, 45, 0, 113, "Section"],
Cell[1247, 45, 369, 10, 28, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[1619, 57, 375, 10, 28, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[1997, 69, 1755, 36, 28, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[3755, 107, 743, 23, 28, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[4501, 132, 86, 2, 45, "Text"],
Cell[CellGroupData[{
Cell[4612, 138, 437, 13, 119, "Input"],
Cell[5052, 153, 2005, 50, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7094, 208, 54, 0, 54, "Subsection"],
Cell[7151, 210, 57, 0, 45, "Text"],
Cell[7211, 212, 307, 5, 102, "Text"],
Cell[7521, 219, 323, 7, 102, "Text"],
Cell[7847, 228, 177, 6, 45, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8073, 240, 37, 0, 113, "Section"],
Cell[8113, 242, 882, 29, 131, "Input"],
Cell[8998, 273, 28, 0, 45, "Text"],
Cell[9029, 275, 223, 6, 90, "Input"],
Cell[9255, 283, 374, 13, 76, "Text"],
Cell[CellGroupData[{
Cell[9654, 300, 975, 29, 206, "Input"],
Cell[10632, 331, 4974, 129, 233, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15643, 465, 84, 2, 60, "Input"],
Cell[15730, 469, 4688, 127, 233, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20467, 602, 28, 0, 113, "Section"],
Cell[20498, 604, 171, 3, 74, "Text"],
Cell[20672, 609, 155, 5, 60, "Input"],
Cell[20830, 616, 217, 4, 74, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21084, 625, 31, 0, 113, "Section"],
Cell[CellGroupData[{
Cell[21140, 629, 40, 0, 54, "Subsection"],
Cell[21183, 631, 107, 3, 45, "Text"],
Cell[21293, 636, 854, 23, 206, "Input"],
Cell[CellGroupData[{
Cell[22172, 663, 255, 9, 60, "Input"],
Cell[22430, 674, 3010, 82, 132, "Output"]
}, Open  ]],
Cell[25455, 759, 187, 6, 45, "Text"],
Cell[CellGroupData[{
Cell[25667, 769, 103, 3, 60, "Input"],
Cell[25773, 774, 852, 21, 131, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26674, 801, 41, 0, 54, "Subsection"],
Cell[26718, 803, 164, 3, 74, "Text"],
Cell[26885, 808, 867, 25, 206, "Input"],
Cell[CellGroupData[{
Cell[27777, 837, 256, 9, 60, "Input"],
Cell[28036, 848, 3233, 86, 132, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31318, 940, 41, 0, 54, "Subsection"],
Cell[31362, 942, 96, 2, 45, "Text"],
Cell[31461, 946, 190, 6, 60, "Input"],
Cell[CellGroupData[{
Cell[31676, 956, 80, 2, 60, "Input"],
Cell[31759, 960, 659, 19, 131, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32467, 985, 40, 0, 54, "Subsection"],
Cell[32510, 987, 95, 2, 45, "Text"],
Cell[32608, 991, 134, 4, 60, "Input"],
Cell[CellGroupData[{
Cell[32767, 999, 79, 2, 60, "Input"],
Cell[32849, 1003, 852, 21, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33738, 1029, 280, 9, 60, "Input"],
Cell[34021, 1040, 2005, 50, 132, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36075, 1096, 40, 0, 54, "Subsection"],
Cell[36118, 1098, 231, 7, 60, "Input"],
Cell[CellGroupData[{
Cell[36374, 1109, 305, 10, 60, "Input"],
Cell[36682, 1121, 1696, 46, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38415, 1172, 298, 9, 60, "Input"],
Cell[38716, 1183, 12464, 329, 435, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51229, 1518, 30, 0, 54, "Subsection"],
Cell[51262, 1520, 473, 15, 131, "Input"],
Cell[51738, 1537, 66, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[51829, 1541, 83, 2, 60, "Input"],
Cell[51915, 1545, 31, 0, 59, "Output"]
}, Open  ]],
Cell[51961, 1548, 50, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[52036, 1552, 94, 2, 60, "Input"],
Cell[52133, 1556, 31, 0, 59, "Output"]
}, Open  ]],
Cell[52179, 1559, 75, 0, 45, "Text"],
Cell[52257, 1561, 150, 4, 60, "Input"],
Cell[52410, 1567, 64, 0, 45, "Text"],
Cell[52477, 1569, 150, 4, 60, "Input"],
Cell[52630, 1575, 94, 2, 45, "Text"],
Cell[CellGroupData[{
Cell[52749, 1581, 197, 7, 60, "Input"],
Cell[52949, 1590, 108, 2, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53094, 1597, 197, 7, 60, "Input"],
Cell[53294, 1606, 106, 2, 59, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53461, 1615, 42, 0, 113, "Section"],
Cell[53506, 1617, 277, 5, 102, "Text"],
Cell[CellGroupData[{
Cell[53808, 1626, 27, 0, 54, "Subsection"],
Cell[53838, 1628, 3042, 101, 359, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56917, 1734, 26, 0, 54, "Subsection"],
Cell[56946, 1736, 281, 5, 102, "Text"],
Cell[57230, 1743, 13839, 358, 1772, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71106, 2106, 32, 0, 54, "Subsection"],
Cell[71141, 2108, 1322, 46, 177, "Input"],
Cell[CellGroupData[{
Cell[72488, 2158, 29, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[72542, 2162, 62, 1, 60, "Input"],
Cell[72607, 2165, 1086, 28, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73730, 2198, 63, 1, 60, "Input"],
Cell[73796, 2201, 2005, 50, 132, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75850, 2257, 28, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[75903, 2261, 113, 3, 60, "Input"],
Cell[76019, 2266, 1086, 28, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77142, 2299, 141, 4, 60, "Input"],
Cell[77286, 2305, 207, 8, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77530, 2318, 141, 4, 60, "Input"],
Cell[77674, 2324, 207, 8, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77918, 2337, 174, 6, 60, "Input"],
Cell[78095, 2345, 207, 8, 59, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78351, 2359, 29, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[78405, 2363, 94, 2, 60, "Input"],
Cell[78502, 2367, 1745, 43, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80284, 2415, 93, 2, 60, "Input"],
Cell[80380, 2419, 1027, 18, 65, "Message"],
Cell[81410, 2439, 1618, 45, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83065, 2489, 107, 3, 60, "Input"],
Cell[83175, 2494, 263, 10, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83475, 2509, 121, 3, 60, "Input"],
Cell[83599, 2514, 3598, 88, 233, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87234, 2607, 151, 4, 60, "Input"],
Cell[87388, 2613, 3342, 79, 233, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90779, 2698, 28, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[90832, 2702, 120, 3, 60, "Input"],
Cell[90955, 2707, 7110, 159, 233, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98102, 2871, 150, 4, 60, "Input"],
Cell[98255, 2877, 3349, 79, 233, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101653, 2962, 30, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[101708, 2966, 122, 3, 60, "Input"],
Cell[101833, 2971, 3598, 88, 233, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105480, 3065, 28, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[105533, 3069, 92, 2, 60, "Input"],
Cell[105628, 3073, 63519, 1443, 188, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169184, 4521, 150, 4, 60, "Input"],
Cell[169337, 4527, 2405, 58, 233, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171779, 4590, 106, 3, 60, "Input"],
Cell[171888, 4595, 460, 9, 35, "Message"],
Cell[172351, 4606, 302, 11, 59, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172702, 4623, 29, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[172756, 4627, 151, 4, 60, "Input"],
Cell[172910, 4633, 885, 26, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173832, 4664, 146, 4, 60, "Input"],
Cell[173981, 4670, 3476, 92, 334, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177494, 4767, 146, 4, 60, "Input"],
Cell[177643, 4773, 3564, 92, 334, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181244, 4870, 146, 4, 60, "Input"],
Cell[181393, 4876, 3476, 92, 334, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184906, 4973, 146, 4, 60, "Input"],
Cell[185055, 4979, 3564, 92, 334, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188668, 5077, 30, 0, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[188723, 5081, 161, 5, 60, "Input"],
Cell[188887, 5088, 659, 19, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189583, 5112, 158, 4, 60, "Input"],
Cell[189744, 5118, 5864, 155, 435, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195645, 5278, 158, 4, 60, "Input"],
Cell[195806, 5284, 5864, 155, 435, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201707, 5444, 158, 4, 60, "Input"],
Cell[201868, 5450, 5864, 155, 435, "Output"]
}, Open  ]]
}, Open  ]],
Cell[207759, 5609, 28, 0, 39, "Subsubsection"],
Cell[207790, 5611, 27, 0, 28, "Subsubsection"],
Cell[207820, 5613, 26, 0, 28, "Subsubsection"],
Cell[207849, 5615, 28, 0, 28, "Subsubsection"],
Cell[207880, 5617, 27, 0, 28, "Subsubsection"],
Cell[207910, 5619, 28, 0, 28, "Subsubsection"],
Cell[207941, 5621, 29, 0, 28, "Subsubsection"],
Cell[207973, 5623, 29, 0, 28, "Subsubsection"],
Cell[208005, 5625, 30, 0, 28, "Subsubsection"],
Cell[208038, 5627, 27, 0, 28, "Subsubsection"],
Cell[208068, 5629, 27, 0, 28, "Subsubsection"],
Cell[208098, 5631, 27, 0, 28, "Subsubsection"],
Cell[208128, 5633, 27, 0, 28, "Subsubsection"],
Cell[208158, 5635, 28, 0, 28, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208223, 5640, 34, 0, 54, "Subsection"],
Cell[208260, 5642, 188, 5, 60, "Input"],
Cell[208451, 5649, 189, 6, 60, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208677, 5660, 40, 0, 54, "Subsection"],
Cell[208720, 5662, 666, 19, 119, "Input"],
Cell[209389, 5683, 6707, 161, 670, "Input"],
Cell[CellGroupData[{
Cell[216121, 5848, 195, 5, 90, "Input"],
Cell[216319, 5855, 211, 4, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216567, 5864, 95, 2, 60, "Input"],
Cell[216665, 5868, 145, 3, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216847, 5876, 243, 8, 60, "Input"],
Cell[217093, 5886, 434, 9, 35, "Message"],
Cell[217530, 5897, 112, 2, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217679, 5904, 216, 6, 60, "Input"],
Cell[217898, 5912, 1403, 29, 212, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219350, 5947, 36, 0, 54, "Subsection"],
Cell[219389, 5949, 16217, 417, 2439, "Input"],
Cell[235609, 6368, 62, 1, 60, "Input"],
Cell[CellGroupData[{
Cell[235696, 6373, 171, 6, 60, "Input"],
Cell[235870, 6381, 434, 9, 35, "Message"],
Cell[236307, 6392, 112, 2, 59, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[236480, 6401, 35, 0, 113, "Section"],
Cell[CellGroupData[{
Cell[236540, 6405, 2020, 63, 264, "Input"],
Cell[238563, 6470, 434, 9, 35, "Message"],
Cell[239000, 6481, 112, 2, 59, "Output"],
Cell[239115, 6485, 434, 9, 35, "Message"],
Cell[239552, 6496, 112, 2, 59, "Output"],
Cell[239667, 6500, 434, 9, 35, "Message"],
Cell[240104, 6511, 112, 2, 59, "Output"],
Cell[240219, 6515, 434, 9, 35, "Message"],
Cell[240656, 6526, 112, 2, 59, "Output"],
Cell[240771, 6530, 464, 9, 35, "Message"],
Cell[241238, 6541, 464, 9, 35, "Message"],
Cell[241705, 6552, 464, 9, 35, "Message"],
Cell[242172, 6563, 486, 10, 35, "Message"],
Cell[242661, 6575, 498, 16, 106, "Output"]
}, Open  ]],
Cell[243174, 6594, 257, 8, 60, "Input"],
Cell[CellGroupData[{
Cell[243456, 6606, 398, 12, 60, "Input"],
Cell[243857, 6620, 3454, 98, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247348, 6723, 347, 11, 60, "Input"],
Cell[247698, 6736, 1011, 31, 131, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248758, 6773, 26, 0, 113, "Section"],
Cell[248787, 6775, 43, 0, 45, "Text"],
Cell[248833, 6777, 14118, 340, 931, "Input"],
Cell[CellGroupData[{
Cell[262976, 7121, 47, 0, 54, "Subsection"],
Cell[263026, 7123, 670, 22, 131, "Input"],
Cell[CellGroupData[{
Cell[263721, 7149, 114, 3, 60, "Input"],
Cell[263838, 7154, 156, 3, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264031, 7162, 114, 3, 60, "Input"],
Cell[264148, 7167, 156, 3, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264341, 7175, 114, 3, 60, "Input"],
Cell[264458, 7180, 156, 3, 59, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
